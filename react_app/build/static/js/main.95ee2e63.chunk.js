(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){e.exports=n(276)},137:function(e,t,n){},215:function(e,t,n){},217:function(e,t,n){},276:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(47),c=n.n(r),i=(n(137),n(21)),s=n(22),l=n(24),u=n(23),h=n(25),d=n(277),m=n(40),f=n.n(m),v={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",flexDirection:"column"},b=function(){return o.a.createElement("div",{style:v},o.a.createElement(d.a,{to:"/manage",style:{textDecoration:"none"}},o.a.createElement(f.a,{variant:"contained",color:"primary"},"Manage")))},p=n(279),g=n(278),k=n(26),_=n.n(k),E=n(48),w=n(3),O=n(12),j=n.n(O),y=(n(215),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._onDetected=n._onDetected.bind(Object(w.a)(Object(w.a)(n))),n._isMobileDevice=n._isMobileDevice.bind(Object(w.a)(Object(w.a)(n))),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{id:"interactive",className:"viewport"},o.a.createElement("video",{className:this._isMobileDevice()?null:"scanningVideo",autoPlay:!0,preload:"auto",src:"",muted:!0,playsInline:!0}),o.a.createElement("canvas",{className:"drawingBuffer"}))}},{key:"_isMobileDevice",value:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},{key:"componentDidMount",value:function(){j.a.init({inputStream:{type:"LiveStream",constraints:{width:640,height:480,facingMode:"environment"},area:{top:"15%",right:"15%",left:"15%",bottom:"15%"}},locator:{patchSize:"x-large",halfSample:!0},numOfWorkers:2,decoder:{readers:["ean_reader"],debug:{showCanvas:!0,showPatches:!0,showFoundPatches:!0,showSkeleton:!0,showLabels:!0,showPatchLabels:!0,showRemainingPatchLabels:!0,boxFromPatches:{showTransformed:!0,showTransformedBox:!0,showBB:!0}}},locate:!0},function(e){if(e)return console.log(e);j.a.start()}),j.a.onProcessed(function(e){var t=j.a.canvas.ctx.overlay,n=j.a.canvas.dom.overlay;e&&e.boxes&&(t.clearRect(0,0,parseInt(n.getAttribute("width")),parseInt(n.getAttribute("height"))),e.boxes.filter(function(t){return t!==e.box}).forEach(function(e){j.a.ImageDebug.drawPath(e,{x:0,y:1},t,{color:"green",lineWidth:2})}))}),j.a.onDetected(this._onDetected)}},{key:"componentWillUnmount",value:function(){j.a.offDetected(this._onDetected),j.a.stop()}},{key:"_onDetected",value:function(e){this.props.onDetected(e)&&j.a.stop()}}]),t}(a.Component)),B=(n(217),n(131)),S={scanning:!1,results:[],bookTitle:null,candidateISBN:null,imageLink:null,authors:null,error:null},x=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state=S,n._scan=n._scan.bind(Object(w.a)(Object(w.a)(n))),n._onDetected=n._onDetected.bind(Object(w.a)(Object(w.a)(n))),n._continueScanning=n._continueScanning.bind(Object(w.a)(Object(w.a)(n))),n._reachedMaxResults=n._reachedMaxResults.bind(Object(w.a)(Object(w.a)(n))),n.mode=n.mode.bind(Object(w.a)(Object(w.a)(n))),n._resultThresholdAchieved=n._resultThresholdAchieved.bind(Object(w.a)(Object(w.a)(n))),n._saveBook=n._saveBook.bind(Object(w.a)(Object(w.a)(n))),n._percentage=n._percentage.bind(Object(w.a)(Object(w.a)(n))),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"mode",value:function(e){return e.sort(function(t,n){return e.filter(function(e){return e===t}).length-e.filter(function(e){return e===n}).length}).pop()}},{key:"getBookDetails",value:function(){var e=Object(E.a)(_.a.mark(function e(t){var n,a=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat("https://www.googleapis.com/books/v1/volumes?q=isbn:").concat(t),e.abrupt("return",fetch(n).then(function(e){return e.json().then(function(t){return{data:t,status:e.status}})}).then(function(e){if(e.data.totalItems){var t=e.data.items[0],n=t.volumeInfo.title,o=t.volumeInfo.authors.join(", "),r=t.volumeInfo.imageLinks,c=r&&r.thumbnail;a.setState({bookTitle:n,authors:o,imageLink:c,error:""})}else a.setState({bookTitle:"",authors:"",imageLink:"",error:"ISBN not found"})}).catch(function(e){throw a.setState({bookTitle:"",authors:"",imageLink:"",error:"Something went wrong"}),e}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_saveBook",value:function(){var e=this;this.props.saveBook(this.state.bookTitle,this.state.candidateISBN,this.state.authors,this.state.imageLink).then(function(t){e.setState(S)})}},{key:"render",value:function(){return o.a.createElement("div",{style:{marginTop:"10px"}},o.a.createElement("div",null,o.a.createElement(d.a,{to:"/",style:{textDecoration:"none",marginRight:"10px",marginLeft:"10px"}},o.a.createElement(f.a,{variant:"contained",color:"primary"},"Back")),o.a.createElement(f.a,{onClick:this._scan,variant:"contained",color:"primary"},this.state.scanning?"Stop Scanning":"Scan Book ISBN")),this.state.scanning&&o.a.createElement("div",{style:{marginTop:"10px",marginBottom:"10px",maxWidth:"500px"}},o.a.createElement(B.a,{percent:this._percentage(),strokeWidth:"1",strokeColor:"#7ce26c"})),this.state.scanning&&o.a.createElement("div",null,o.a.createElement("div",null,"Scanning",o.a.createElement("span",{className:this.state.scanning?"loader__dot":null},"."),o.a.createElement("span",{className:this.state.scanning?"loader__dot":null},"."),o.a.createElement("span",{className:this.state.scanning?"loader__dot":null},".")),o.a.createElement(y,{onDetected:this._onDetected})),o.a.createElement("div",null,this._resultThresholdAchieved()&&!this.state.scanning&&this.state.candidateISBN),o.a.createElement("div",null,this._resultThresholdAchieved()&&!this.state.scanning&&this.state.bookTitle),o.a.createElement("div",null,this._resultThresholdAchieved()&&!this.state.scanning&&this.state.authors),o.a.createElement("div",null,this._resultThresholdAchieved()&&!this.state.scanning&&this.state.error),this._resultThresholdAchieved()&&!this.state.scanning&&o.a.createElement("img",{src:this.state.imageLink,alt:"Missing"}),this._resultThresholdAchieved()&&!this.state.scanning&&!this.state.error&&o.a.createElement("div",null,o.a.createElement(f.a,{type:"submit",variant:"contained",color:"secondary",onClick:this._saveBook},"Add book")))}},{key:"_percentage",value:function(){return this.state.results.length/20*100}},{key:"_resultThresholdAchieved",value:function(){return this.state.results.length>=20}},{key:"_scan",value:function(){this.setState({results:[],scanning:!this.state.scanning,error:""})}},{key:"_onDetected",value:function(e){var t=this.state.results.concat([e]);if(this.setState({results:t,scanning:this._continueScanning(t)}),this._reachedMaxResults(t)){var n=this.mode(this.state.results.map(function(e){return e.codeResult.code}));this.setState({candidateISBN:n}),this.getBookDetails(n)}return this._reachedMaxResults(t)}},{key:"_continueScanning",value:function(e){return!this._reachedMaxResults(e)&&this.state.scanning}},{key:"_reachedMaxResults",value:function(e){return e.length>=20}}]),t}(a.Component),T=n(129),A=n(126),D=n.n(A),P=n(128),I=n.n(P),R=n(14),N=n.n(R),C=n(127),M=n.n(C),L=n(84),U=n.n(L),W=n(125),q=n.n(W),H=Object(T.withStyles)(function(e){return{root:{width:"100%",marginTop:3*e.spacing.unit,overflowX:"auto"},table:{minWidth:700},tableRowHover:{"&:hover":{backgroundColor:e.palette.grey[200]}}}})(function(e){var t=e.classes;return o.a.createElement(q.a,{className:t.root},o.a.createElement(D.a,{className:t.table},o.a.createElement(M.a,null,o.a.createElement(U.a,null,o.a.createElement(N.a,null,"Image"),o.a.createElement(N.a,null,"Book Title"),o.a.createElement(N.a,null,"Authors"),o.a.createElement(N.a,{align:"right"},"ISBN"))),o.a.createElement(I.a,null,e.books.map(function(e){return o.a.createElement(U.a,{key:e.id,className:t.tableRowHover},o.a.createElement(N.a,{component:"th",scope:"row"},o.a.createElement("img",{style:{height:"120px"},src:e.imageLink,alt:"missing"})),o.a.createElement(N.a,null,e.name),o.a.createElement(N.a,null,e.authors),o.a.createElement(N.a,{align:"right"},e.isbn))}))))}),J=n(62),V=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={books:[]},n.fetchBooks=n.fetchBooks.bind(Object(w.a)(Object(w.a)(n))),n.saveBook=n.saveBook.bind(Object(w.a)(Object(w.a)(n))),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.fetchBooks()}},{key:"fetchBooks",value:function(){var e=Object(E.a)(_.a.mark(function e(){var t,n=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_BOOK_API_URL:"https://www.googleapis.com/books/v1/volumes?q=isbn:"}).REACT_APP_API_URL||window.location.origin,"/api/offices/1/books"),e.abrupt("return",fetch(t,{method:"GET",mode:"cors",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(e){if(e.ok)return e;throw Error("Request rejected with status ".concat(e.status))}).then(function(e){return e.json().then(function(t){return{data:t.data,status:e.status}})}).then(function(e){return n.setState({books:e.data.books})}).catch(function(e){throw e}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"saveBook",value:function(){var e=Object(E.a)(_.a.mark(function e(t,n,a,o){var r,c=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_BOOK_API_URL:"https://www.googleapis.com/books/v1/volumes?q=isbn:"}).REACT_APP_API_URL||window.location.origin,"/api/offices/1/books"),e.abrupt("return",fetch(r,{method:"POST",mode:"cors",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:t,isbn:n,authors:a,imageLink:o})}).then(function(e){if(e.ok)return e;throw Error("Request rejected with status ".concat(e.status))}).then(function(e){Object(J.toast)("Book saved!"),c.fetchBooks()}).catch(function(e){throw e}));case 2:case"end":return e.stop()}},e,this)}));return function(t,n,a,o){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(x,{saveBook:this.saveBook}),o.a.createElement(H,{books:this.state.books}))}}]),t}(a.Component),F=(n(273),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement(p.a,null,o.a.createElement("div",null,o.a.createElement(g.a,{path:"/",exact:!0,component:b}),o.a.createElement(g.a,{path:"/manage",component:V}),o.a.createElement(J.ToastContainer,{autoClose:3e3})))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[132,2,1]]]);
//# sourceMappingURL=main.95ee2e63.chunk.js.map